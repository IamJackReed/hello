<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Market Diary | Jack Reed</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="dark-theme.css">
    <link rel="stylesheet" href="light-theme.css">
    <link rel="stylesheet" href="theme-toggle.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <style>
        .portfolio-summary {
            margin-bottom: 3rem;
        }
        
        .summary-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .summary-card {
            background: var(--color-bg-alt);
            border: 1px solid var(--color-border);
            padding: 1.5rem;
            border-radius: 8px;
        }
        
        .summary-label {
            font-size: 0.875rem;
            color: var(--color-text-light);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 0.5rem;
        }
        
        .summary-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--color-text);
        }
        
        .summary-value--gain {
            color: #4BB78F;
        }
        
        .summary-value--loss {
            color: #FE4B60;
        }
        
        .holdings-grid {
            display: grid;
            gap: 1rem;
        }
        
        .holding-card {
            background: var(--color-bg-alt);
            border: 1px solid var(--color-border);
            padding: 1.5rem;
            border-radius: 8px;
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr 1fr;
            gap: 1rem;
            align-items: center;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        
        .holding-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .holding-name {
            font-weight: 600;
            font-size: 1rem;
        }
        
        .holding-stat {
            text-align: right;
        }
        
        .holding-stat-label {
            font-size: 0.75rem;
            color: var(--color-text-light);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            display: block;
            margin-bottom: 0.25rem;
        }
        
        .holding-stat-value {
            font-size: 1rem;
            font-weight: 600;
        }
        
        .positive {
            color: #4BB78F;
        }
        
        .negative {
            color: #FE4B60;
        }
        
        .section-divider {
            margin: 3rem 0;
            padding: 1.5rem;
            background: var(--color-bg-elevated);
            border-left: 4px solid var(--color-accent);
            border-radius: 4px;
        }
        
        .section-divider h3 {
            margin: 0;
            font-size: 1.25rem;
        }
        
        @media (max-width: 768px) {
            .holding-card {
                grid-template-columns: 1fr;
                gap: 0.75rem;
            }
            
            .holding-stat {
                text-align: left;
                display: flex;
                justify-content: space-between;
                align-items: center;
            }
            
            .holding-stat-label {
                margin-bottom: 0;
            }
            
            .chart-section > div[style*="grid-template-columns"] {
                grid-template-columns: 1fr !important;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="nav">
        <div class="nav-container">
            <button class="nav-toggle" aria-label="Toggle navigation">
                <span></span>
                <span></span>
                <span></span>
            </button>
            <a href="/" class="nav-logo">Jack Reed</a>
            <div class="nav-search">
                <input type="text" id="search-input" placeholder="Search posts by hashtag..." aria-label="Search posts">
                <button id="search-button" aria-label="Search">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"></circle>
                        <path d="m21 21-4.35-4.35"></path>
                    </svg>
                </button>
            </div>
            <ul class="nav-menu">
                <li><a href="/">Home</a></li>
                <li><a href="people-and-teams.html">People & Teams</a></li>
                <li><a href="product.html">Product</a></li>
                <li><a href="organisation-and-change.html">Organisation & Change</a></li>
                <li><a href="market-diary.html">Market Diary</a></li>
                <li><a href="about.html">About</a></li>
            </ul>
        </div>
    </nav>

    <main class="content-page">
        <div class="container">
            <!-- Disclaimer Banner -->
            <div class="disclaimer-banner">
                <h3>‚ö†Ô∏è Disclaimer</h3>
                <p><strong>Nothing on this site is financial advice.</strong> These are my personal notes and opinions, shared for educational and informational purposes only. They do not constitute investment advice, recommendation, or invitation to buy or sell any security. Please do your own research and, if needed, speak to a regulated financial adviser.</p>
            </div>

            <header class="page-header">
                <h1>Market Diary</h1>
                <p class="page-intro">This is my personal market diary‚Äîa place where I share my thinking about markets, companies, and capital allocation. It's not advice. It's a record of how I think about investing.</p>
            </header>

            <!-- Portfolio Summary -->
            <section class="portfolio-summary">
                <div class="summary-cards">
                    <div class="summary-card">
                        <div class="summary-label">Total Portfolio Value</div>
                        <div class="summary-value" id="total-value">¬£0.00</div>
                    </div>
                    <div class="summary-card">
                        <div class="summary-label">Total Investment</div>
                        <div class="summary-value" id="total-cost">¬£0.00</div>
                    </div>
                    <div class="summary-card">
                        <div class="summary-label">Total Profit/Loss</div>
                        <div class="summary-value" id="total-pl">¬£0.00</div>
                    </div>
                    <div class="summary-card">
                        <div class="summary-label">Return (%)</div>
                        <div class="summary-value" id="total-return">0.00%</div>
                    </div>
                </div>
            </section>

            <!-- Asset Allocation -->
            <section class="chart-section">
                <h2>Asset Allocation</h2>
                <div class="bar-chart" id="asset-allocation">
                    <!-- Will be populated by JavaScript -->
                </div>
            </section>

            <!-- Portfolio Composition Pie Chart -->
            <section class="chart-section">
                <h2>Portfolio Composition</h2>
                <div style="background: var(--color-bg-alt); border: 1px solid var(--color-border); padding: 2rem; border-radius: 8px;">
                    <canvas id="portfolio-pie-chart" style="max-height: 400px;"></canvas>
                </div>
            </section>

            <!-- Top Performers & Losers -->
            <section class="chart-section">
                <h2>Top Performers & Biggest Losers</h2>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-bottom: 2rem;">
                    <div style="background: var(--color-bg-alt); border: 1px solid var(--color-border); padding: 1.5rem; border-radius: 8px;">
                        <h3 style="color: #4BB78F; margin-bottom: 1rem;">üöÄ Top 5 Performers</h3>
                        <div id="top-performers"></div>
                    </div>
                    <div style="background: var(--color-bg-alt); border: 1px solid var(--color-border); padding: 1.5rem; border-radius: 8px;">
                        <h3 style="color: #FE4B60; margin-bottom: 1rem;">üìâ Biggest Losers</h3>
                        <div id="top-losers"></div>
                    </div>
                </div>
            </section>

            <!-- Performance Distribution -->
            <section class="chart-section">
                <h2>Performance Distribution</h2>
                <div style="background: var(--color-bg-alt); border: 1px solid var(--color-border); padding: 2rem; border-radius: 8px;">
                    <canvas id="performance-chart" style="max-height: 300px;"></canvas>
                </div>
            </section>

            <!-- Holdings by Size -->
            <section class="chart-section">
                <h2>Top 10 Holdings by Value</h2>
                <div style="background: var(--color-bg-alt); border: 1px solid var(--color-border); padding: 2rem; border-radius: 8px;">
                    <canvas id="holdings-bar-chart" style="max-height: 400px;"></canvas>
                </div>
            </section>

            <!-- Stocks Holdings -->
            <section class="holdings-section">
                <h2>Stock Holdings</h2>
                <div class="holdings-grid" id="stocks-grid">
                    <!-- Will be populated by JavaScript -->
                </div>
            </section>

            <!-- Funds Holdings -->
            <div class="section-divider">
                <h3>Investment Funds</h3>
            </div>
            
            <section class="holdings-section">
                <div class="holdings-grid" id="funds-grid">
                    <!-- Will be populated by JavaScript -->
                </div>
            </section>
        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <p>&copy; 2026 Jack Reed. All rights reserved.</p>
                <div class="social-icons">
                    <a href="https://uk.linkedin.com/in/iamjackreed" target="_blank" rel="noopener noreferrer" aria-label="LinkedIn">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/>
                        </svg>
                    </a>
                    <a href="https://www.instagram.com/jack.ross.reed/" target="_blank" rel="noopener noreferrer" aria-label="Instagram">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
                        </svg>
                    </a>
                    <a href="https://twitter.com/jackrossreed" target="_blank" rel="noopener noreferrer" aria-label="X (Twitter)">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                        </svg>
                    </a>
                </div>
            </div>
        </div>
    </footer>

    <script src="main.js"></script>
    <script src="search.js"></script>
    <script>
        // Embedded portfolio data - replace this when you update your Excel
        const portfolioData = [{"Unnamed: 0":null,"COMPANIES":"COMPANY","Unnamed: 2":"Ticker","Unnamed: 3":"QUANTITY HELD","Unnamed: 4":"BOOK COST","Unnamed: 5":"Value (¬£)","Unnamed: 6":"PROFIT / LOSS (%)","Unnamed: 7":"HOLDING (%)","Unnamed: 8":"PROFIT / LOSS (¬£)","Unnamed: 9":"Price (p)","Unnamed: 10":"BUY PRICE"},{"Unnamed: 0":1.0,"COMPANIES":"AdvancedAdvT Limited","Unnamed: 2":null,"Unnamed: 3":1000,"Unnamed: 4":1500,"Unnamed: 5":1870,"Unnamed: 6":0.2466666667,"Unnamed: 7":0.0300894101,"Unnamed: 8":370,"Unnamed: 9":1.87,"Unnamed: 10":1.5},{"Unnamed: 0":2.0,"COMPANIES":"AMCOMRI GROUP PLC","Unnamed: 2":null,"Unnamed: 3":300,"Unnamed: 4":1500,"Unnamed: 5":330,"Unnamed: 6":-0.78,"Unnamed: 7":0.0053098959,"Unnamed: 8":-1170,"Unnamed: 9":1.1,"Unnamed: 10":5},{"Unnamed: 0":3.0,"COMPANIES":"Ashtead Technology Holdings PLC","Unnamed: 2":null,"Unnamed: 3":300,"Unnamed: 4":1000,"Unnamed: 5":1083,"Unnamed: 6":0.083,"Unnamed: 7":0.0174261129,"Unnamed: 8":83,"Unnamed: 9":3.61,"Unnamed: 10":3.3333333333},{"Unnamed: 0":4.0,"COMPANIES":"Beeks Financial Cloud Group PLC","Unnamed: 2":null,"Unnamed: 3":1000,"Unnamed: 4":1500,"Unnamed: 5":2182.45,"Unnamed: 6":0.4549666667,"Unnamed: 7":0.0351169161,"Unnamed: 8":682.45,"Unnamed: 9":2.18245,"Unnamed: 10":1.5},{"Unnamed: 0":5.0,"COMPANIES":"BRAVE BISON GROUP PLC","Unnamed: 2":null,"Unnamed: 3":1000,"Unnamed: 4":1000,"Unnamed: 5":802.51,"Unnamed: 6":-0.19749,"Unnamed: 7":0.0129128623,"Unnamed: 8":-197.49,"Unnamed: 9":0.80251,"Unnamed: 10":1},{"Unnamed: 0":6.0,"COMPANIES":"CAKE BOX HOLDINGS PLC","Unnamed: 2":null,"Unnamed: 3":1000,"Unnamed: 4":1500,"Unnamed: 5":2050,"Unnamed: 6":0.3666666667,"Unnamed: 7":0.032985717,"Unnamed: 8":550,"Unnamed: 9":2.05,"Unnamed: 10":1.5},{"Unnamed: 0":7.0,"COMPANIES":"DSW CAPITAL PLC","Unnamed: 2":null,"Unnamed: 3":2000,"Unnamed: 4":1000,"Unnamed: 5":1100,"Unnamed: 6":0.1,"Unnamed: 7":0.017699653,"Unnamed: 8":100,"Unnamed: 9":0.55,"Unnamed: 10":0.5},{"Unnamed: 0":8.0,"COMPANIES":"HARGREAVES SERVICES PLC","Unnamed: 2":null,"Unnamed: 3":300,"Unnamed: 4":2000,"Unnamed: 5":2063.466,"Unnamed: 6":0.031733,"Unnamed: 7":0.0332023929,"Unnamed: 8":63.466,"Unnamed: 9":6.87822,"Unnamed: 10":6.6666666667},{"Unnamed: 0":9.0,"COMPANIES":"M&C SAATCHI PLC","Unnamed: 2":null,"Unnamed: 3":1000,"Unnamed: 4":1500,"Unnamed: 5":1475,"Unnamed: 6":-0.0166666667,"Unnamed: 7":0.0237336256,"Unnamed: 8":-25,"Unnamed: 9":1.475,"Unnamed: 10":1.5},{"Unnamed: 0":10.0,"COMPANIES":"ONE HEALTH GROUP PLC","Unnamed: 2":null,"Unnamed: 4":2000,"Unnamed: 5":2434.75,"Unnamed: 6":0.217375,"Unnamed: 7":0.0391765729,"Unnamed: 8":434.75,"Unnamed: 9":2.43475,"Unnamed: 10":2},{"Unnamed: 0":11.0,"COMPANIES":"PERSONAL GROUP HOLDINGS PLC","Unnamed: 2":null,"Unnamed: 3":1000,"Unnamed: 4":3000,"Unnamed: 5":3168.8,"Unnamed: 6":0.0562666667,"Unnamed: 7":0.0509878731,"Unnamed: 8":168.8,"Unnamed: 9":3.1688,"Unnamed: 10":3},{"Unnamed: 0":12.0,"COMPANIES":"RAMSDENS HOLDINGS PLC.","Unnamed: 2":null,"Unnamed: 3":1000,"Unnamed: 4":3000,"Unnamed: 5":3493.2,"Unnamed: 6":0.1644,"Unnamed: 7":0.0562076617,"Unnamed: 8":493.2,"Unnamed: 9":3.4932,"Unnamed: 10":3},{"Unnamed: 0":13.0,"COMPANIES":"TIME FINANCE PLC","Unnamed: 2":null,"Unnamed: 3":2000,"Unnamed: 4":1000,"Unnamed: 5":1074,"Unnamed: 6":0.074,"Unnamed: 7":0.0172812976,"Unnamed: 8":74,"Unnamed: 9":0.537,"Unnamed: 10":0.5},{"Unnamed: 0":14.0,"COMPANIES":"WARPAINT LONDON PLC","Unnamed: 2":null,"Unnamed: 3":1000,"Unnamed: 4":3000,"Unnamed: 5":2074.375,"Unnamed: 6":-0.3085416667,"Unnamed: 7":0.0333779252,"Unnamed: 8":-925.625,"Unnamed: 9":2.074375,"Unnamed: 10":3},{"Unnamed: 0":15.0,"COMPANIES":"JOURNEO PLC","Unnamed: 2":null,"Unnamed: 3":1200,"Unnamed: 4":4000,"Unnamed: 5":5568,"Unnamed: 6":0.392,"Unnamed: 7":0.0895924254,"Unnamed: 8":1568,"Unnamed: 9":4.64,"Unnamed: 10":3.3333333333},{"Unnamed: 0":16.0,"COMPANIES":"SYNECTICS PLC","Unnamed: 2":null,"Unnamed: 3":1000,"Unnamed: 4":3000,"Unnamed: 5":3016,"Unnamed: 6":0.0053333333,"Unnamed: 7":0.0485292304,"Unnamed: 8":16,"Unnamed: 9":3.016,"Unnamed: 10":3},{"Unnamed: 0":17.0,"COMPANIES":"CONCURRENT TECHNOLOGIES PLC","Unnamed: 2":null,"Unnamed: 3":1000,"Unnamed: 4":1500,"Unnamed: 5":2214,"Unnamed: 6":0.476,"Unnamed: 7":0.0356245743,"Unnamed: 8":714,"Unnamed: 9":2.214,"Unnamed: 10":1.5},{"Unnamed: 0":18.0,"COMPANIES":"ANPARIO PLC","Unnamed: 2":null,"Unnamed: 3":1000,"Unnamed: 4":4000,"Unnamed: 5":5184.5,"Unnamed: 6":0.296125,"Unnamed: 7":0.0834216828,"Unnamed: 8":1184.5,"Unnamed: 9":5.1845,"Unnamed: 10":4},{"Unnamed: 0":19.0,"COMPANIES":"QUARTIX TECHNOLOGIES PLC","Unnamed: 2":null,"Unnamed: 3":1000,"Unnamed: 4":2500,"Unnamed: 5":3003.25,"Unnamed: 6":0.2013,"Unnamed: 7":0.0483240754,"Unnamed: 8":503.25,"Unnamed: 9":3.00325,"Unnamed: 10":2.5},{"Unnamed: 0":20.0,"COMPANIES":"GAMING REALMS PLC","Unnamed: 2":null,"Unnamed: 3":1000,"Unnamed: 4":500,"Unnamed: 5":468.43,"Unnamed: 6":-0.06314,"Unnamed: 7":0.0075373168,"Unnamed: 8":-31.57,"Unnamed: 9":0.46843,"Unnamed: 10":0.5},{"Unnamed: 0":null,"COMPANIES":null,"Unnamed: 2":null,"Unnamed: 3":null,"Unnamed: 4":40000,"Unnamed: 5":44655.731,"Unnamed: 6":null,"Unnamed: 7":null,"Unnamed: 8":null,"Unnamed: 9":null,"Unnamed: 10":null},{"Unnamed: 0":null,"COMPANIES":null,"Unnamed: 2":null,"Unnamed: 3":null,"Unnamed: 4":null,"Unnamed: 5":null,"Unnamed: 6":null,"Unnamed: 7":null,"Unnamed: 8":null,"Unnamed: 9":null,"Unnamed: 10":null},{"Unnamed: 0":null,"COMPANIES":"FUNDS","Unnamed: 2":null,"Unnamed: 3":null,"Unnamed: 4":null,"Unnamed: 5":null,"Unnamed: 6":null,"Unnamed: 7":null,"Unnamed: 8":null,"Unnamed: 9":null,"Unnamed: 10":null},{"Unnamed: 0":null,"COMPANIES":"COMPANY","Unnamed: 2":"Ticker","Unnamed: 3":"QUANTITY HELD","Unnamed: 4":"BOOK COST","Unnamed: 5":"Value (¬£)","Unnamed: 6":"PROFIT / LOSS (%)","Unnamed: 7":"HOLDING (%)","Unnamed: 8":"PROFIT / LOSS (¬£)","Unnamed: 9":"Price (p)","Unnamed: 10":"BUY PRICE"},{"Unnamed: 0":21.0,"COMPANIES":"GlX Uranium UCITS ETF USD Acc","Unnamed: 2":null,"Unnamed: 3":300,"Unnamed: 4":5300,"Unnamed: 5":6493.68,"Unnamed: 6":0.2252226415,"Unnamed: 7":0.1044871662,"Unnamed: 8":1193.68,"Unnamed: 9":21.6456,"Unnamed: 10":17.6666666667},{"Unnamed: 0":22.0,"COMPANIES":"Vanguard Life Strategy 80% Equity","Unnamed: 2":null,"Unnamed: 3":30,"Unnamed: 4":9000,"Unnamed: 5":9998.7,"Unnamed: 6":0.1109666667,"Unnamed: 7":0.1608850187,"Unnamed: 8":998.7,"Unnamed: 9":333.29,"Unnamed: 10":300},{"Unnamed: 0":null,"COMPANIES":null,"Unnamed: 2":null,"Unnamed: 3":null,"Unnamed: 4":14300,"Unnamed: 5":16492.38,"Unnamed: 6":null,"Unnamed: 7":null,"Unnamed: 8":null,"Unnamed: 9":null,"Unnamed: 10":null},{"Unnamed: 0":null,"COMPANIES":null,"Unnamed: 2":null,"Unnamed: 3":null,"Unnamed: 4":null,"Unnamed: 5":null,"Unnamed: 6":null,"Unnamed: 7":null,"Unnamed: 8":null,"Unnamed: 9":null,"Unnamed: 10":null},{"Unnamed: 0":null,"COMPANIES":"COMPANIES","Unnamed: 2":null,"Unnamed: 3":null,"Unnamed: 4":null,"Unnamed: 5":null,"Unnamed: 6":null,"Unnamed: 7":null,"Unnamed: 8":null,"Unnamed: 9":null,"Unnamed: 10":null},{"Unnamed: 0":null,"COMPANIES":"TOTAL STOCKS PURCHASE COST","Unnamed: 2":null,"Unnamed: 3":40000,"Unnamed: 4":null,"Unnamed: 5":null,"Unnamed: 6":null,"Unnamed: 7":null,"Unnamed: 8":null,"Unnamed: 9":null,"Unnamed: 10":null},{"Unnamed: 0":null,"COMPANIES":"TOAL STOCKS VALUE NOW","Unnamed: 2":null,"Unnamed: 3":44655.731,"Unnamed: 4":null,"Unnamed: 5":null,"Unnamed: 6":null,"Unnamed: 7":null,"Unnamed: 8":null,"Unnamed: 9":null,"Unnamed: 10":null},{"Unnamed: 0":null,"COMPANIES":"TOTAL PROFIT OR LOSS ON STOCKS","Unnamed: 2":null,"Unnamed: 3":4655.731,"Unnamed: 4":null,"Unnamed: 5":null,"Unnamed: 6":null,"Unnamed: 7":null,"Unnamed: 8":null,"Unnamed: 9":null,"Unnamed: 10":null},{"Unnamed: 0":null,"COMPANIES":null,"Unnamed: 2":null,"Unnamed: 3":null,"Unnamed: 4":null,"Unnamed: 5":null,"Unnamed: 6":null,"Unnamed: 7":null,"Unnamed: 8":null,"Unnamed: 9":null,"Unnamed: 10":null},{"Unnamed: 0":null,"COMPANIES":"FUNDS","Unnamed: 2":null,"Unnamed: 3":null,"Unnamed: 4":null,"Unnamed: 5":null,"Unnamed: 6":null,"Unnamed: 7":null,"Unnamed: 8":null,"Unnamed: 9":null,"Unnamed: 10":null},{"Unnamed: 0":null,"COMPANIES":"TOTAL FUND PURCHASE COST","Unnamed: 2":null,"Unnamed: 3":14300,"Unnamed: 4":null,"Unnamed: 5":null,"Unnamed: 6":null,"Unnamed: 7":null,"Unnamed: 8":null,"Unnamed: 9":null,"Unnamed: 10":null},{"Unnamed: 0":null,"COMPANIES":"TOAL FUND VALUE NOW","Unnamed: 2":null,"Unnamed: 3":16492.38,"Unnamed: 4":null,"Unnamed: 5":null,"Unnamed: 6":null,"Unnamed: 7":null,"Unnamed: 8":null,"Unnamed: 9":null,"Unnamed: 10":null},{"Unnamed: 0":null,"COMPANIES":"STOCKS GAIN / LOSS","Unnamed: 2":null,"Unnamed: 3":2192.38,"Unnamed: 4":null,"Unnamed: 5":null,"Unnamed: 6":null,"Unnamed: 7":null,"Unnamed: 8":null,"Unnamed: 9":null,"Unnamed: 10":null},{"Unnamed: 0":null,"COMPANIES":null,"Unnamed: 2":null,"Unnamed: 3":null,"Unnamed: 4":null,"Unnamed: 5":null,"Unnamed: 6":null,"Unnamed: 7":null,"Unnamed: 8":null,"Unnamed: 9":null,"Unnamed: 10":null},{"Unnamed: 0":null,"COMPANIES":"TOTAL PORTFOLIO","Unnamed: 2":null,"Unnamed: 3":null,"Unnamed: 4":null,"Unnamed: 5":null,"Unnamed: 6":null,"Unnamed: 7":null,"Unnamed: 8":null,"Unnamed: 9":null,"Unnamed: 10":null},{"Unnamed: 0":null,"COMPANIES":"TOTAL INVESTMENT COST","Unnamed: 2":null,"Unnamed: 3":54300,"Unnamed: 4":null,"Unnamed: 5":null,"Unnamed: 6":null,"Unnamed: 7":null,"Unnamed: 8":null,"Unnamed: 9":null,"Unnamed: 10":null},{"Unnamed: 0":null,"COMPANIES":"TOTAL INVESTMENT VALUE NOW","Unnamed: 2":null,"Unnamed: 3":61148.111,"Unnamed: 4":null,"Unnamed: 5":null,"Unnamed: 6":null,"Unnamed: 7":null,"Unnamed: 8":null,"Unnamed: 9":null,"Unnamed: 10":null},{"Unnamed: 0":null,"COMPANIES":"TOTAL INVESTMENT PROFIT / LOSS (¬£)","Unnamed: 2":null,"Unnamed: 3":6848.111,"Unnamed: 4":null,"Unnamed: 5":null,"Unnamed: 6":null,"Unnamed: 7":null,"Unnamed: 8":null,"Unnamed: 9":null,"Unnamed: 10":null},{"Unnamed: 0":null,"COMPANIES":"TOTAL INVESTMENT PROFIT / LOSS (%)","Unnamed: 2":null,"Unnamed: 3":0.1261162247,"Unnamed: 4":null,"Unnamed: 5":null,"Unnamed: 6":null,"Unnamed: 7":null,"Unnamed: 8":null,"Unnamed: 9":null,"Unnamed: 10":null},{"Unnamed: 0":null,"COMPANIES":null,"Unnamed: 2":null,"Unnamed: 3":null,"Unnamed: 4":null,"Unnamed: 5":null,"Unnamed: 6":null,"Unnamed: 7":null,"Unnamed: 8":null,"Unnamed: 9":null,"Unnamed: 10":null},{"Unnamed: 0":null,"COMPANIES":"ASSET TYPE","Unnamed: 2":null,"Unnamed: 3":"AMOUNT (¬£)","Unnamed: 4":"% OF TPV","Unnamed: 5":null,"Unnamed: 6":null,"Unnamed: 7":null,"Unnamed: 8":null,"Unnamed: 9":null,"Unnamed: 10":null},{"Unnamed: 0":null,"COMPANIES":"CASH","Unnamed: 2":null,"Unnamed: 3":1000,"Unnamed: 4":0.0160905936,"Unnamed: 5":null,"Unnamed: 6":null,"Unnamed: 7":null,"Unnamed: 8":null,"Unnamed: 9":null,"Unnamed: 10":null},{"Unnamed: 0":null,"COMPANIES":"STOCKS","Unnamed: 2":null,"Unnamed: 3":44655.731,"Unnamed: 4":0.7185372215,"Unnamed: 5":null,"Unnamed: 6":null,"Unnamed: 7":null,"Unnamed: 8":null,"Unnamed: 9":null,"Unnamed: 10":null},{"Unnamed: 0":null,"COMPANIES":"FUNDS","Unnamed: 2":null,"Unnamed: 3":16492.38,"Unnamed: 4":0.2653721848,"Unnamed: 5":null,"Unnamed: 6":null,"Unnamed: 7":null,"Unnamed: 8":null,"Unnamed: 9":null,"Unnamed: 10":null},{"Unnamed: 0":null,"COMPANIES":"TOTAL PORTFOLIO VALUE","Unnamed: 2":null,"Unnamed: 3":62148.111,"Unnamed: 4":1,"Unnamed: 5":null,"Unnamed: 6":null,"Unnamed: 7":null,"Unnamed: 8":null,"Unnamed: 9":null,"Unnamed: 10":null}];
        
        // Display the data immediately
        displayPortfolioData(portfolioData);

        function displayPortfolioData(data) {
            // Find summary data
            const totalInvestment = data.find(row => row.COMPANIES === 'TOTAL INVESTMENT COST');
            const totalValue = data.find(row => row.COMPANIES === 'TOTAL INVESTMENT VALUE NOW');
            const totalPL = data.find(row => row.COMPANIES === 'TOTAL INVESTMENT PROFIT / LOSS (¬£)');
            const totalReturn = data.find(row => row.COMPANIES === 'TOTAL INVESTMENT PROFIT / LOSS (%)');
            
            // Update summary cards
            if (totalValue) {
                document.getElementById('total-value').textContent = `¬£${formatNumber(totalValue['Unnamed: 3'])}`;
            }
            if (totalInvestment) {
                document.getElementById('total-cost').textContent = `¬£${formatNumber(totalInvestment['Unnamed: 3'])}`;
            }
            if (totalPL) {
                const plValue = totalPL['Unnamed: 3'];
                const plElement = document.getElementById('total-pl');
                plElement.textContent = `¬£${formatNumber(plValue)}`;
                plElement.className = plValue >= 0 ? 'summary-value summary-value--gain' : 'summary-value summary-value--loss';
            }
            if (totalReturn) {
                const returnValue = totalReturn['Unnamed: 3'];
                const returnElement = document.getElementById('total-return');
                returnElement.textContent = `${(returnValue * 100).toFixed(2)}%`;
                returnElement.className = returnValue >= 0 ? 'summary-value summary-value--gain' : 'summary-value summary-value--loss';
            }
            
            // Display asset allocation
            const cash = data.find(row => row.COMPANIES === 'CASH');
            const stocks = data.find(row => row.COMPANIES === 'STOCKS' && row['Unnamed: 3'] > 1000);
            const funds = data.find(row => row.COMPANIES === 'FUNDS' && row['Unnamed: 3'] > 1000);
            
            const allocationHTML = `
                ${cash ? `
                <div class="bar-chart-item">
                    <div class="bar-chart-label">Cash</div>
                    <div class="bar-chart-bar-container">
                        <div class="bar-chart-bar" style="width: ${(cash['Unnamed: 4'] * 100).toFixed(1)}%;" data-value="${(cash['Unnamed: 4'] * 100).toFixed(1)}%"></div>
                    </div>
                </div>` : ''}
                ${stocks ? `
                <div class="bar-chart-item">
                    <div class="bar-chart-label">Stocks</div>
                    <div class="bar-chart-bar-container">
                        <div class="bar-chart-bar" style="width: ${(stocks['Unnamed: 4'] * 100).toFixed(1)}%;" data-value="${(stocks['Unnamed: 4'] * 100).toFixed(1)}%"></div>
                    </div>
                </div>` : ''}
                ${funds ? `
                <div class="bar-chart-item">
                    <div class="bar-chart-label">Funds</div>
                    <div class="bar-chart-bar-container">
                        <div class="bar-chart-bar" style="width: ${(funds['Unnamed: 4'] * 100).toFixed(1)}%;" data-value="${(funds['Unnamed: 4'] * 100).toFixed(1)}%"></div>
                    </div>
                </div>` : ''}
            `;
            document.getElementById('asset-allocation').innerHTML = allocationHTML;
            
            // Display stocks (rows 1-20)
            const stocks_data = data.filter(row => row['Unnamed: 0'] >= 1 && row['Unnamed: 0'] <= 20);
            const stocksHTML = stocks_data.map(stock => createHoldingCard(stock)).join('');
            document.getElementById('stocks-grid').innerHTML = stocksHTML;
            
            // Display funds (rows 21-22)
            const funds_data = data.filter(row => row['Unnamed: 0'] >= 21 && row['Unnamed: 0'] <= 22);
            const fundsHTML = funds_data.map(fund => createHoldingCard(fund)).join('');
            document.getElementById('funds-grid').innerHTML = fundsHTML;
            
            // Create charts
            createCharts(data);
        }

        function createHoldingCard(holding) {
            const plPercent = holding['Unnamed: 6'] * 100;
            const plClass = plPercent >= 0 ? 'positive' : 'negative';
            const plSign = plPercent >= 0 ? '+' : '';
            
            return `
                <div class="holding-card">
                    <div class="holding-name">${holding.COMPANIES}</div>
                    <div class="holding-stat">
                        <span class="holding-stat-label">Value</span>
                        <span class="holding-stat-value">¬£${formatNumber(holding['Unnamed: 5'])}</span>
                    </div>
                    <div class="holding-stat">
                        <span class="holding-stat-label">Cost</span>
                        <span class="holding-stat-value">¬£${formatNumber(holding['Unnamed: 4'])}</span>
                    </div>
                    <div class="holding-stat">
                        <span class="holding-stat-label">P/L</span>
                        <span class="holding-stat-value ${plClass}">${plSign}${plPercent.toFixed(2)}%</span>
                    </div>
                    <div class="holding-stat">
                        <span class="holding-stat-label">Holding</span>
                        <span class="holding-stat-value">${(holding['Unnamed: 7'] * 100).toFixed(2)}%</span>
                    </div>
                </div>
            `;
        }

        function formatNumber(num) {
            if (!num) return '0.00';
            return parseFloat(num).toLocaleString('en-GB', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
        }
    </script>
</body>
